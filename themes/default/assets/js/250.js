"use strict";(self.webpackChunkjohncms=self.webpackChunkjohncms||[]).push([[250],{6235:(e,t,i)=>{i.d(t,{Z:()=>o});var r=i(1519),n=i.n(r)()((function(e){return e[1]}));n.push([e.id,".vicp-step1 .vicp-drop-area{align-items:center;background-color:rgba(0,0,0,.03);border:1px dashed rgba(0,0,0,.08);box-sizing:border-box;cursor:pointer;display:flex;height:140px;justify-content:center;overflow:hidden;padding:35px;position:relative;text-align:center}.vicp-step2 .vicp-crop .vicp-crop-left .vicp-img-container{background-color:#e5e5e0;display:block;height:180px;overflow:hidden;position:relative;width:240px}.vicp-step2 .vicp-crop .vicp-crop-left .vicp-img-container .vicp-img{cursor:move;display:block;position:absolute;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.vicp-step2 .vicp-crop .vicp-crop-left .vicp-img-container .vicp-img-shade{background-color:hsla(210,8%,95%,.8);box-shadow:0 2px 6px 0 rgba(0,0,0,.18);position:absolute}.vicp-step2 .vicp-crop .vicp-crop-left .vicp-img-container .vicp-img-shade.vicp-img-shade-1{left:0;top:0}.vicp-step2 .vicp-crop .vicp-crop-left .vicp-img-container .vicp-img-shade.vicp-img-shade-2{bottom:0;right:0}.vicp-step2 .vicp-crop .vicp-crop-right .vicp-preview .vicp-preview-item{height:100px;margin-right:16px;padding:0 5px;position:relative;width:100px}.vicp-step2 .vicp-crop .vicp-crop-right .vicp-preview .vicp-preview-item span{color:#bbb;display:block;font-size:14px;text-align:center;width:100%}.vicp-step2 .vicp-crop .vicp-crop-right .vicp-preview .vicp-preview-item img{background-color:#fff;border:1px solid rgba(0,0,0,.15);display:block;margin:auto;overflow:hidden;padding:3px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.vicp-step2 .vicp-crop .vicp-crop-right .vicp-preview .vicp-preview-item.vicp-preview-item-circle{margin-right:0}.vicp-step2 .vicp-crop .vicp-crop-right .vicp-preview .vicp-preview-item.vicp-preview-item-circle img{border-radius:100%}",""]);const o=n},7250:(e,t,i)=>{i.r(t),i.d(t,{default:()=>pe});var r=i(821),n={class:"position-relative"},o={key:0,class:"text-center add-photo-btn"},a=[(0,r._)("div",{class:"add-photo-icon"},"+",-1),(0,r._)("div",{class:"add-photo-text"},"Add photo",-1)],s={key:1,class:"change-photo-btn"},l=[(0,r._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-camera"},[(0,r._)("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),(0,r._)("circle",{cx:"12",cy:"13",r:"4"})],-1)],c=["action"],p=["value"],u={key:0,type:"submit",class:"btn btn-link delete-photo-btn text-decoration-none cursor-pointer"};var d=["id","aria-labelledby"],h={class:"modal-dialog modal-lg modal-fullscreen-md-down"},g={class:"modal-content"},m=(0,r._)("div",{class:"modal-header"},[(0,r._)("h5",{class:"modal-title",id:"exampleModalLabel"},"Add avatar"),(0,r._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),v={class:"modal-body"},f={class:"vicp-step1"},w={class:"w-100 pb-2"},y={class:"vicp-icon1"},b=[(0,r._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"44",height:"44",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-upload"},[(0,r._)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,r._)("polyline",{points:"17 8 12 3 7 8"}),(0,r._)("line",{x1:"12",y1:"3",x2:"12",y2:"15"})],-1)],k={class:"vicp-error text-danger pt-2"},x=(0,r._)("i",{class:"vicp-icon2"},null,-1),S={class:"vicp-operate mt-3"},_={type:"button","data-bs-dismiss":"modal",class:"btn btn-outline-secondary"},I={key:0,class:"vicp-step2"},D={class:"vicp-crop d-flex flex-wrap"},M={class:"vicp-crop-left me-4"},C=["src"],z={class:"d-flex align-items-center mt-2"},U={class:"vicp-range d-flex justify-content-between flex-grow-1"},j=[(0,r._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-minus-circle"},[(0,r._)("circle",{cx:"12",cy:"12",r:"10"}),(0,r._)("line",{x1:"8",y1:"12",x2:"16",y2:"12"})],-1)],T=["value"],Z=[(0,r._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-plus-circle"},[(0,r._)("circle",{cx:"12",cy:"12",r:"10"}),(0,r._)("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),(0,r._)("line",{x1:"8",y1:"12",x2:"16",y2:"12"})],-1)],F={key:0,class:"vicp-rotate ps-1 cursor-pointer"},A=[(0,r._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-rotate-cw"},[(0,r._)("polyline",{points:"23 4 23 10 17 10"}),(0,r._)("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})],-1)],E={class:"vicp-crop-right"},O={class:"vicp-preview d-flex"},W={key:0,class:"vicp-preview-item"},q=["src"],H={key:1,class:"vicp-preview-item vicp-preview-item-circle"},B=["src"],R={class:"vicp-operate mt-3"},$={key:1,class:"vicp-step3"},L={class:"vicp-upload"},V={class:"vicp-progress-wrap"},X={class:"alert alert-danger"},P=(0,r._)("i",{class:"vicp-icon2"},null,-1),Y={class:"alert alert-success"},N=(0,r._)("i",{class:"vicp-icon3"},null,-1),J={class:"vicp-operate mt-3"},G={type:"button","data-bs-dismiss":"modal",class:"btn btn-primary"},K=["width","height"];var Q=i(2971),ee=i(421),te=i(6979);function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}const re={props:{field:{type:String,default:"avatar"},modalId:{type:String,default:"uploadAvatar"},ki:{type:String,default:"0"},modelValue:{type:Boolean,default:!0},url:{type:String,default:""},params:{type:Object,default:function(){return null}},headers:{type:Object,default:function(){return null}},width:{type:Number,default:200},height:{type:Number,default:200},noRotate:{type:Boolean,default:!0},noCircle:{type:Boolean,default:!1},noSquare:{type:Boolean,default:!1},maxSize:{type:Number,default:10240},langType:{type:String,default:"zh"},langExt:{type:Object,default:function(){return null}},imgFormat:{type:String,default:"png"},imgBgc:{type:String,default:"#fff"},withCredentials:{type:Boolean,default:!1},method:{type:String,default:"POST"},initialImgUrl:{type:String,default:""},allowImgFormat:{type:Array,default:function(){return["gif","jpg","png"]}}},data:function(){var e=this,t=e.imgFormat,i=e.allowImgFormat,r=e.langType,n=e.langExt,o=e.width,a=e.height,s=!0,l=-1===i.indexOf(t)?"jpg":t,c=Q.Z[r]?Q.Z[r]:Q.Z.en,p=ee.Z[l];return n&&Object.assign(c,n),"function"!=typeof FormData&&(s=!1),{mime:p,lang:c,isSupported:s,isSupportTouch:document.hasOwnProperty("ontouchstart"),step:1,loading:0,progress:0,hasError:!1,errorMsg:"",ratio:o/a,sourceImg:null,sourceImgUrl:this.initialImgUrl,createImgUrl:this.initialImgUrl,sourceImgMouseDown:{on:!1,mX:0,mY:0,x:0,y:0},previewContainer:{width:100,height:100},sourceImgContainer:{width:240,height:184},scale:{zoomAddOn:!1,zoomSubOn:!1,range:1,x:0,y:0,width:0,height:0,maxWidth:0,maxHeight:0,minWidth:0,minHeight:0,naturalWidth:0,naturalHeight:0}}},computed:{progressStyle:function(){return{width:this.progress+"%"}},sourceImgStyle:function(){var e=this.scale,t=this.sourceImgMasking;return{top:e.y+t.y+"px",left:e.x+t.x+"px",width:e.width+"px",height:e.height+"px"}},sourceImgMasking:function(){var e=this.width,t=this.height,i=this.ratio,r=this.sourceImgContainer,n=r.width/r.height,o=0,a=0,s=r.width,l=r.height,c=1;return i<n&&(c=r.height/t,s=r.height*i,o=(r.width-s)/2),i>n&&(c=r.width/e,l=r.width/i,a=(r.height-l)/2),{scale:c,x:o,y:a,width:s,height:l}},sourceImgShadeStyle:function(){var e=this.sourceImgMasking,t=this.sourceImgContainer,i=e;return{width:(i.width==t.width?i.width:(t.width-i.width)/2)+"px",height:(i.height==t.height?i.height:(t.height-i.height)/2)+"px"}},previewStyle:function(){var e=this.ratio,t=this.previewContainer,i=t.width,r=t.height,n=i/r;return e<n&&(i=t.height*e),e>n&&(r=t.width/e),{width:i+"px",height:r+"px"}}},watch:{modelValue:function(e){e&&1!=this.loading&&this.reset()}},created:function(){document.addEventListener("keyup",this.handleEscClose)},beforeUnmount:function(){document.removeEventListener("keyup",this.handleEscClose)},mounted:function(){this.sourceImgUrl&&this.startCrop()},methods:{handleEscClose:function(e){!this.modelValue||"Escape"!=e.key&&27!=e.keyCode||this.off()},off:function(){var e=this;setTimeout((function(){e.$emit("update:modelValue",!1),3==e.step&&2==e.loading&&e.setStep(1)}),200)},setStep:function(e){var t=this;setTimeout((function(){t.step=e}),200)},preventDefault:function(e){return e.preventDefault(),!1},handleClick:function(e){1!==this.loading&&e.target!==this.$refs.fileinput&&(e.preventDefault(),document.activeElement!==this.$refs&&this.$refs.fileinput.click())},handleChange:function(e){if(e.preventDefault(),1!==this.loading){var t=e.target.files||e.dataTransfer.files;this.reset(),this.checkFile(t[0])&&this.setSourceImg(t[0])}},checkFile:function(e){var t=this,i=t.lang,r=t.maxSize;return-1===e.type.indexOf("image")?(t.hasError=!0,t.errorMsg=i.error.onlyImg,!1):!(e.size/1024>r)||(t.hasError=!0,t.errorMsg=i.error.outOfSize+r+"kb",!1)},reset:function(){var e=this;e.loading=0,e.hasError=!1,e.errorMsg="",e.progress=0},setSourceImg:function(e){this.$emit("src-file-set",e.name,e.type,e.size);var t=this,i=new FileReader;i.onload=function(){t.sourceImgUrl=i.result,t.startCrop()},i.readAsDataURL(e)},startCrop:function(){var e=this,t=e.width,i=e.height,r=e.ratio,n=e.scale,o=e.sourceImgUrl,a=e.sourceImgMasking,s=e.lang,l=a,c=new Image;c.src=o,c.onload=function(){var o=c.naturalWidth,a=c.naturalHeight,p=o/a,u=l.width,d=l.height,h=0,g=0;if(o<t||a<i)return e.hasError=!0,e.errorMsg=s.error.lowestPx+t+"*"+i,!1;r>p&&(d=u/p,g=(l.height-d)/2),r<p&&(u=d*p,h=(l.width-u)/2),n.range=0,n.x=h,n.y=g,n.width=u,n.height=d,n.minWidth=u,n.minHeight=d,n.maxWidth=o*l.scale,n.maxHeight=a*l.scale,n.naturalWidth=o,n.naturalHeight=a,e.sourceImg=c,e.createImg(),e.setStep(2)}},imgStartMove:function(e){if(e.preventDefault(),this.isSupportTouch&&!e.targetTouches)return!1;var t=e.targetTouches?e.targetTouches[0]:e,i=this.sourceImgMouseDown,r=this.scale,n=i;n.mX=t.screenX,n.mY=t.screenY,n.x=r.x,n.y=r.y,n.on=!0},imgMove:function(e){if(e.preventDefault(),this.isSupportTouch&&!e.targetTouches)return!1;var t=e.targetTouches?e.targetTouches[0]:e,i=this.sourceImgMouseDown,r=i.on,n=i.mX,o=i.mY,a=i.x,s=i.y,l=this.scale,c=this.sourceImgMasking,p=a+(t.screenX-n),u=s+(t.screenY-o);r&&(p>0&&(p=0),u>0&&(u=0),p<c.width-l.width&&(p=c.width-l.width),u<c.height-l.height&&(u=c.height-l.height),l.x=p,l.y=u)},rotateImg:function(){var e=this.sourceImg,t=this.scale,i=t.naturalWidth,r=t.naturalHeight,n=r,o=i,a=this.$refs.canvas,s=a.getContext("2d");a.width=n,a.height=o,s.clearRect(0,0,n,o),s.fillStyle="rgba(0,0,0,0)",s.fillRect(0,0,n,o),s.translate(n,0),s.rotate(90*Math.PI/180),s.drawImage(e,0,0,i,r);var l=a.toDataURL(ee.Z.png);this.sourceImgUrl=l,this.startCrop()},handleMouseWheel:function(e){e=e||window.event;var t=this.scale;e.wheelDelta?(e.wheelDelta>0&&this.zoomImg(t.range>=100?100:++t.range),e.wheelDelta<0&&this.zoomImg(t.range<=0?0:--t.range)):e.detail&&(e.detail>0&&this.zoomImg(t.range>=100?100:++t.range),e.detail<0&&this.zoomImg(t.range<=0?0:--t.range))},startZoomAdd:function(){var e=this,t=e.scale;t.zoomAddOn=!0,function i(){if(t.zoomAddOn){var r=t.range>=100?100:++t.range;e.zoomImg(r),setTimeout((function(){i()}),60)}}()},endZoomAdd:function(){this.scale.zoomAddOn=!1},startZoomSub:function(){var e=this,t=e.scale;t.zoomSubOn=!0,function i(){if(t.zoomSubOn){var r=t.range<=0?0:--t.range;e.zoomImg(r),setTimeout((function(){i()}),60)}}()},endZoomSub:function(){this.scale.zoomSubOn=!1},zoomChange:function(e){this.zoomImg(e.target.value)},zoomImg:function(e){var t=this,i=this.sourceImgMasking,r=this.scale,n=r.maxWidth,o=r.maxHeight,a=r.minWidth,s=r.minHeight,l=r.width,c=r.height,p=r.x,u=r.y,d=i,h=d.width,g=d.height,m=a+(n-a)*e/100,v=s+(o-s)*e/100,f=h/2-m/l*(h/2-p),w=g/2-v/c*(g/2-u);f>0&&(f=0),w>0&&(w=0),f<h-m&&(f=h-m),w<g-v&&(w=g-v),r.x=f,r.y=w,r.width=m,r.height=v,r.range=e,setTimeout((function(){r.range==e&&t.createImg()}),300)},createImg:function(e){var t=this,i=t.imgFormat,r=t.imgBgc,n=t.mime,o=t.sourceImg,a=t.scale,s=a.x,l=a.y,c=a.width,p=a.height,u=t.sourceImgMasking.scale,d=t.$refs.canvas,h=d.getContext("2d");e&&(t.sourceImgMouseDown.on=!1),d.width=t.width,d.height=t.height,h.clearRect(0,0,t.width,t.height),h.fillStyle="png"==i?"rgba(0,0,0,0)":r,h.fillRect(0,0,t.width,t.height),h.drawImage(o,s/u,l/u,c/u,p/u),t.createImgUrl=d.toDataURL(n)},prepareUpload:function(){var e=this.url,t=this.createImgUrl,i=this.field,r=this.ki;this.$emit("crop-success",t,i,r),"string"==typeof e&&e?this.upload():this.off()},upload:function(){var e=this,t=this.lang,i=this.imgFormat,r=this.mime,n=this.url,o=this.params,a=this.headers,s=this.field,l=this.ki,c=this.createImgUrl,p=this.withCredentials,u=this.method,d=new FormData;"object"==ie(o)&&o&&Object.keys(o).forEach((function(e){d.append(e,o[e])})),d.append(s,(0,te.Z)(c,r),s+"."+i);var h=function(t){t.lengthComputable&&(e.progress=100*Math.round(t.loaded)/t.total)};e.reset(),e.loading=1,e.setStep(3),new Promise((function(e,t){var i=new XMLHttpRequest;i.open(u,n,!0),i.withCredentials=p,i.onreadystatechange=function(){4===this.readyState&&(200===this.status||201===this.status||202===this.staus?e(JSON.parse(this.responseText)):t(this.status))},i.upload.addEventListener("progress",h,!1),"object"==ie(a)&&a&&Object.keys(a).forEach((function(e){i.setRequestHeader(e,a[e])})),i.send(d)})).then((function(t){e.loading=2,e.$emit("crop-upload-success",t.url,s,l)}),(function(i){e.loading=3,e.hasError=!0,e.errorMsg=t.fail,e.$emit("crop-upload-fail",i,s,l)}))}}};var ne=i(3379),oe=i.n(ne),ae=i(6235),se={insert:"head",singleton:!1};oe()(ae.Z,se);ae.Z.locals;var le=i(3744);const ce={components:{AvatarUploaderBsModal:(0,le.Z)(re,[["render",function(e,t,i,n,o,a){return(0,r.wg)(),(0,r.iD)("div",null,[(0,r._)("div",{class:"modal fade",id:i.modalId,tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":i.modalId,"aria-hidden":"true"},[(0,r._)("div",h,[(0,r._)("div",g,[m,(0,r._)("div",v,[(0,r.wy)((0,r._)("div",f,[(0,r._)("div",{class:"vicp-drop-area flex-wrap",onDragleave:t[1]||(t[1]=function(){return a.preventDefault&&a.preventDefault.apply(a,arguments)}),onDragover:t[2]||(t[2]=function(){return a.preventDefault&&a.preventDefault.apply(a,arguments)}),onDragenter:t[3]||(t[3]=function(){return a.preventDefault&&a.preventDefault.apply(a,arguments)}),onClick:t[4]||(t[4]=function(){return a.handleClick&&a.handleClick.apply(a,arguments)}),onDrop:t[5]||(t[5]=function(){return a.handleChange&&a.handleChange.apply(a,arguments)})},[(0,r._)("div",w,[(0,r.wy)((0,r._)("i",y,b,512),[[r.F8,1!=o.loading]])]),(0,r.wy)((0,r._)("span",{class:"vicp-hint"},(0,r.zw)(o.lang.hint),513),[[r.F8,1!==o.loading]]),(0,r.wy)((0,r._)("span",{class:"vicp-no-supported-hint"},(0,r.zw)(o.lang.noSupported),513),[[r.F8,!o.isSupported]]),1==o.step?(0,r.wy)(((0,r.wg)(),(0,r.iD)("input",{key:0,type:"file",accept:"image/*",onChange:t[0]||(t[0]=function(){return a.handleChange&&a.handleChange.apply(a,arguments)}),ref:"fileinput"},null,544)),[[r.F8,!1]]):(0,r.kq)("",!0)],32),(0,r.wy)((0,r._)("div",k,[x,(0,r.Uk)(" "+(0,r.zw)(o.errorMsg),1)],512),[[r.F8,o.hasError]]),(0,r._)("div",S,[(0,r._)("button",_,(0,r.zw)(o.lang.btn.off),1)])],512),[[r.F8,1==o.step]]),2==o.step?((0,r.wg)(),(0,r.iD)("div",I,[(0,r._)("div",D,[(0,r.wy)((0,r._)("div",M,[(0,r._)("div",{class:"vicp-img-container",onWheel:t[21]||(t[21]=(0,r.iM)((function(){return a.handleMouseWheel&&a.handleMouseWheel.apply(a,arguments)}),["prevent"]))},[(0,r._)("img",{src:o.sourceImgUrl,style:(0,r.j5)(a.sourceImgStyle),class:"vicp-img",draggable:"false",onDrag:t[6]||(t[6]=function(){return a.preventDefault&&a.preventDefault.apply(a,arguments)}),onDragstart:t[7]||(t[7]=function(){return a.preventDefault&&a.preventDefault.apply(a,arguments)}),onDragend:t[8]||(t[8]=function(){return a.preventDefault&&a.preventDefault.apply(a,arguments)}),onDragleave:t[9]||(t[9]=function(){return a.preventDefault&&a.preventDefault.apply(a,arguments)}),onDragover:t[10]||(t[10]=function(){return a.preventDefault&&a.preventDefault.apply(a,arguments)}),onDragenter:t[11]||(t[11]=function(){return a.preventDefault&&a.preventDefault.apply(a,arguments)}),onDrop:t[12]||(t[12]=function(){return a.preventDefault&&a.preventDefault.apply(a,arguments)}),onTouchstart:t[13]||(t[13]=function(){return a.imgStartMove&&a.imgStartMove.apply(a,arguments)}),onTouchmove:t[14]||(t[14]=function(){return a.imgMove&&a.imgMove.apply(a,arguments)}),onTouchend:t[15]||(t[15]=function(){return a.createImg&&a.createImg.apply(a,arguments)}),onTouchcancel:t[16]||(t[16]=function(){return a.createImg&&a.createImg.apply(a,arguments)}),onMousedown:t[17]||(t[17]=function(){return a.imgStartMove&&a.imgStartMove.apply(a,arguments)}),onMousemove:t[18]||(t[18]=function(){return a.imgMove&&a.imgMove.apply(a,arguments)}),onMouseup:t[19]||(t[19]=function(){return a.createImg&&a.createImg.apply(a,arguments)}),onMouseout:t[20]||(t[20]=function(){return a.createImg&&a.createImg.apply(a,arguments)}),ref:"img"},null,44,C),(0,r._)("div",{class:"vicp-img-shade vicp-img-shade-1",style:(0,r.j5)(a.sourceImgShadeStyle)},null,4),(0,r._)("div",{class:"vicp-img-shade vicp-img-shade-2",style:(0,r.j5)(a.sourceImgShadeStyle)},null,4)],32),(0,r._)("div",z,[(0,r._)("div",U,[(0,r._)("i",{onMousedown:t[22]||(t[22]=function(){return a.startZoomSub&&a.startZoomSub.apply(a,arguments)}),onMouseout:t[23]||(t[23]=function(){return a.endZoomSub&&a.endZoomSub.apply(a,arguments)}),onMouseup:t[24]||(t[24]=function(){return a.endZoomSub&&a.endZoomSub.apply(a,arguments)}),class:"vicp-icon5 pe-1 cursor-pointer"},j,32),(0,r._)("input",{type:"range",class:"form-range flex-grow-1",value:o.scale.range,step:"1",min:"0",max:"100",onMousemove:t[25]||(t[25]=function(){return a.zoomChange&&a.zoomChange.apply(a,arguments)})},null,40,T),(0,r._)("i",{onMousedown:t[26]||(t[26]=function(){return a.startZoomAdd&&a.startZoomAdd.apply(a,arguments)}),onMouseout:t[27]||(t[27]=function(){return a.endZoomAdd&&a.endZoomAdd.apply(a,arguments)}),onMouseup:t[28]||(t[28]=function(){return a.endZoomAdd&&a.endZoomAdd.apply(a,arguments)}),class:"vicp-icon6 ps-1 cursor-pointer"},Z,32)]),i.noRotate?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("div",F,[(0,r._)("i",{onClick:t[29]||(t[29]=function(){return a.rotateImg&&a.rotateImg.apply(a,arguments)}),class:"icon-rotate"},A)]))])],512),[[r.F8,!0]]),(0,r.wy)((0,r._)("div",E,[(0,r._)("div",O,[i.noSquare?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("div",W,[(0,r._)("img",{src:o.createImgUrl,style:(0,r.j5)(a.previewStyle)},null,12,q),(0,r._)("span",null,(0,r.zw)(o.lang.preview),1)])),i.noCircle?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("div",H,[(0,r._)("img",{src:o.createImgUrl,style:(0,r.j5)(a.previewStyle)},null,12,B),(0,r._)("span",null,(0,r.zw)(o.lang.preview),1)]))])],512),[[r.F8,!0]])]),(0,r._)("div",R,[(0,r._)("a",{onClick:t[30]||(t[30]=function(e){return a.setStep(1)}),class:"btn btn-outline-secondary me-2"},(0,r.zw)(o.lang.btn.back),1),(0,r._)("a",{class:"vicp-operate-btn btn btn-primary",onClick:t[31]||(t[31]=function(){return a.prepareUpload&&a.prepareUpload.apply(a,arguments)})},(0,r.zw)(o.lang.btn.save),1)])])):(0,r.kq)("",!0),3==o.step?((0,r.wg)(),(0,r.iD)("div",$,[(0,r._)("div",L,[(0,r.wy)((0,r._)("div",{class:"vicp-loading mb-1"},(0,r.zw)(o.lang.loading),513),[[r.F8,1===o.loading]]),(0,r._)("div",V,[(0,r.wy)((0,r._)("div",{class:"vicp-progress progress",style:(0,r.j5)(a.progressStyle)},[(0,r._)("div",{class:"progress-bar progress-bar-striped progress-bar-animated",role:"progressbar",style:(0,r.j5)(a.progressStyle)},null,4)],4),[[r.F8,1===o.loading]])]),(0,r.wy)((0,r._)("div",X,[P,(0,r.Uk)(" "+(0,r.zw)(o.errorMsg),1)],512),[[r.F8,o.hasError]]),(0,r.wy)((0,r._)("div",Y,[N,(0,r.Uk)(" "+(0,r.zw)(o.lang.success),1)],512),[[r.F8,2===o.loading]])]),(0,r._)("div",J,[(0,r._)("a",{onClick:t[32]||(t[32]=function(e){return a.setStep(2)}),class:"btn btn-outline-secondary me-2"},(0,r.zw)(o.lang.btn.back),1),(0,r._)("button",G,(0,r.zw)(o.lang.btn.close),1)])])):(0,r.kq)("",!0),(0,r.wy)((0,r._)("canvas",{width:i.width,height:i.height,ref:"canvas"},null,8,K),[[r.F8,!1]])])])])],8,d)])}]])},props:{langType:{type:String,default:"ru"},currentAvatar:{type:String,default:""},uploadUrl:{type:String,default:""},deleteUrl:{type:String,default:""},token:{type:String,default:""}},data:function(){return{show:!1,params:{csrf_token:this.token},headers:{},imgUrl:this.currentAvatar}},methods:{toggleShow:function(){this.show=!this.show},cropSuccess:function(e){this.imgUrl=e}}},pe=(0,le.Z)(ce,[["render",function(e,t,i,d,h,g){var m=(0,r.up)("avatar-uploader-bs-modal");return(0,r.wg)(),(0,r.iD)("div",n,[(0,r._)("div",{class:(0,r.C_)(["profile-photo-upload-btn cursor-pointer has-photo",{"border-0":h.imgUrl}]),"data-bs-toggle":"modal","data-bs-target":"#uploadAvatar",style:(0,r.j5)("background: url("+h.imgUrl+")")},[h.imgUrl?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("div",o,a)),h.imgUrl?((0,r.wg)(),(0,r.iD)("div",s,l)):(0,r.kq)("",!0)],6),h.imgUrl?((0,r.wg)(),(0,r.iD)("form",{key:0,action:i.deleteUrl,method:"post"},[(0,r._)("input",{type:"hidden",name:"csrf_token",value:i.token},null,8,p),i.deleteUrl?((0,r.wg)(),(0,r.iD)("button",u,"×")):(0,r.kq)("",!0)],8,c)):(0,r.kq)("",!0),(0,r.Wm)(m,{"modal-id":"uploadAvatar",field:"avatar",onCropUploadSuccess:g.cropSuccess,modelValue:h.show,"onUpdate:modelValue":t[0]||(t[0]=function(e){return h.show=e}),width:300,height:300,url:i.uploadUrl,params:h.params,headers:h.headers,langType:i.langType,"img-format":"png"},null,8,["onCropUploadSuccess","modelValue","url","params","headers","langType"])])}]])}}]);